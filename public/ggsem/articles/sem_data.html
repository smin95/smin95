<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6. Visualizing SEM Diagrams Using Data • ggsem</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="6. Visualizing SEM Diagrams Using Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggsem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/elements.html">1. Drawing Elements</a></li>
    <li><a class="dropdown-item" href="../articles/networks.html">2. Drawing Networks Without Data</a></li>
    <li><a class="dropdown-item" href="../articles/lavaan.html">3. Drawing Structural Equation Modeling Diagrams Without Data</a></li>
    <li><a class="dropdown-item" href="../articles/annotations.html">4. Annotating Any ggplot Objects</a></li>
    <li><a class="dropdown-item" href="../articles/network_data.html">5. Visualizing Network Using Data</a></li>
    <li><a class="dropdown-item" href="../articles/sem_data.html">6. Visualizing SEM Diagrams Using Data</a></li>
    <li><a class="dropdown-item" href="../articles/others.html">7. Other Tips</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/smin95/ggsem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>6. Visualizing SEM Diagrams Using Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/smin95/ggsem/blob/HEAD/vignettes/sem_data.Rmd" class="external-link"><code>vignettes/sem_data.Rmd</code></a></small>
      <div class="d-none name"><code>sem_data.Rmd</code></div>
    </div>

    
    
<p>In this chapter, we will visualize path diagrams from structural
equation modeling (SEM) with data files.</p>
<div class="section level2">
<h2 id="data-formats">Data Formats<a class="anchor" aria-label="anchor" href="#data-formats"></a>
</h2>
<p>The <em>ggsem</em> web application accepts two types of CSV files for
plotting SEM diagrams: <strong>data frame</strong> and
<strong>matrix</strong>. The examples are shown here.</p>
<p>Basically, the data files should be able to understood by the
<strong>lavaan</strong> package. Let’s load data from the
<em>lavaan</em> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://smin95.github.io/ggsem/">ggsem</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span> <span class="co"># install.packages('lavaan')</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">PoliticalDemocracy</span><span class="op">)</span></span>
<span><span class="co">#&gt;      y1       y2       y3       y4       y5       y6       y7       y8       x1</span></span>
<span><span class="co">#&gt; 1  2.50 0.000000 3.333333 0.000000 1.250000 0.000000 3.726360 3.333333 4.442651</span></span>
<span><span class="co">#&gt; 2  1.25 0.000000 3.333333 0.000000 6.250000 1.100000 6.666666 0.736999 5.384495</span></span>
<span><span class="co">#&gt; 3  7.50 8.800000 9.999998 9.199991 8.750000 8.094061 9.999998 8.211809 5.961005</span></span>
<span><span class="co">#&gt; 4  8.90 8.800000 9.999998 9.199991 8.907948 8.127979 9.999998 4.615086 6.285998</span></span>
<span><span class="co">#&gt; 5 10.00 3.333333 9.999998 6.666666 7.500000 3.333333 9.999998 6.666666 5.863631</span></span>
<span><span class="co">#&gt; 6  7.50 3.333333 6.666666 6.666666 6.250000 1.100000 6.666666 0.368500 5.533389</span></span>
<span><span class="co">#&gt;         x2       x3</span></span>
<span><span class="co">#&gt; 1 3.637586 2.557615</span></span>
<span><span class="co">#&gt; 2 5.062595 3.568079</span></span>
<span><span class="co">#&gt; 3 6.255750 5.224433</span></span>
<span><span class="co">#&gt; 4 7.567863 6.267495</span></span>
<span><span class="co">#&gt; 5 6.818924 4.573679</span></span>
<span><span class="co">#&gt; 6 5.135798 3.892270</span></span></code></pre></div>
<p>The first example of data frame <code>PoliticalDemocracy</code> has a
first column with id, where it identifies each row. This is a common
feature for datasets to be analyzed in <strong>lavaan</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">HolzingerSwineford1939</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id sex ageyr agemo  school grade       x1   x2    x3       x4   x5        x6</span></span>
<span><span class="co">#&gt; 1  1   1    13     1 Pasteur     7 3.333333 7.75 0.375 2.333333 5.75 1.2857143</span></span>
<span><span class="co">#&gt; 2  2   2    13     7 Pasteur     7 5.333333 5.25 2.125 1.666667 3.00 1.2857143</span></span>
<span><span class="co">#&gt; 3  3   2    13     1 Pasteur     7 4.500000 5.25 1.875 1.000000 1.75 0.4285714</span></span>
<span><span class="co">#&gt; 4  4   1    13     2 Pasteur     7 5.333333 7.75 3.000 2.666667 4.50 2.4285714</span></span>
<span><span class="co">#&gt; 5  5   2    12     2 Pasteur     7 4.833333 4.75 0.875 2.666667 4.00 2.5714286</span></span>
<span><span class="co">#&gt; 6  6   2    14     1 Pasteur     7 5.333333 5.00 2.250 1.000000 3.00 0.8571429</span></span>
<span><span class="co">#&gt;         x7   x8       x9</span></span>
<span><span class="co">#&gt; 1 3.391304 5.75 6.361111</span></span>
<span><span class="co">#&gt; 2 3.782609 6.25 7.916667</span></span>
<span><span class="co">#&gt; 3 3.260870 3.90 4.416667</span></span>
<span><span class="co">#&gt; 4 3.000000 5.30 4.861111</span></span>
<span><span class="co">#&gt; 5 3.695652 6.30 5.916667</span></span>
<span><span class="co">#&gt; 6 4.347826 6.65 7.500000</span></span></code></pre></div>
<p>The second example of data frame <code>HolzingerSwineford1939</code>
also has a first column with id, where it identifies each row. Other
column names refer to each variable (observed or latent).</p>
<p>If you plan to use your custom data files, please make sure they have
similar structures as those in these two examples.</p>
<p>You can download the datasets into your directory using these
codes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'https://www.smin95.com/HolzingerSwineford1939.csv'</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">df1</span>, <span class="st">'HolzingerSwineford1939.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'https://www.smin95.com/PoliticalDemocracy.csv'</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">df2</span>, <span class="st">'PoliticalDemocracy.csv'</span><span class="op">)</span></span></code></pre></div>
<p>Another format of data frame that <strong>ggsem</strong> recognizes
is matrix, as shown below. This is directly from the example in
<strong>lavaan</strong>’s documentation website (<a href="https://lavaan.ugent.be/tutorial/cov.html" class="external-link uri">https://lavaan.ugent.be/tutorial/cov.html</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st"> 11.834</span></span>
<span><span class="st">  6.947   9.364</span></span>
<span><span class="st">  6.819   5.091  12.532</span></span>
<span><span class="st">  4.783   5.028   7.495   9.986</span></span>
<span><span class="st"> -3.839  -3.889  -3.841  -3.625  9.610</span></span>
<span><span class="st">-21.899 -18.831 -21.748 -18.775 35.522 450.288 '</span></span>
<span></span>
<span><span class="va">wheaton.cov</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/getCov.html" class="external-link">getCov</a></span><span class="op">(</span><span class="va">lower</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anomia67"</span>, <span class="st">"powerless67"</span>, </span>
<span>                          <span class="st">"anomia71"</span>, <span class="st">"powerless71"</span>,</span>
<span>                          <span class="st">"education"</span>, <span class="st">"sei"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wheaton.cov</span></span>
<span><span class="co">#&gt;             anomia67 powerless67 anomia71 powerless71 education     sei</span></span>
<span><span class="co">#&gt; anomia67      11.834       6.947    6.819       4.783    -3.839 -21.899</span></span>
<span><span class="co">#&gt; powerless67    6.947       9.364    5.091       5.028    -3.889 -18.831</span></span>
<span><span class="co">#&gt; anomia71       6.819       5.091   12.532       7.495    -3.841 -21.748</span></span>
<span><span class="co">#&gt; powerless71    4.783       5.028    7.495       9.986    -3.625 -18.775</span></span>
<span><span class="co">#&gt; education     -3.839      -3.889   -3.841      -3.625     9.610  35.522</span></span>
<span><span class="co">#&gt; sei          -21.899     -18.831  -21.748     -18.775    35.522 450.288</span></span></code></pre></div>
<p>There are few things that are noticeable from the matrix. The first
element (row 1, column 1) is empty. The first column has names for
variables. The column names match the names of the rows. The matrix has
a symmetrical structure. This structure of matrix is recognized by the
<strong>lavaan</strong> package, which <strong>ggsem</strong> uses to
perform statistical analyses. Make sure to upload CSV file with this
matrix structure in <strong>ggsem</strong>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrix_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'https://www.smin95.com/wheaton_cov.csv'</span>,</span>
<span>                                     row.names <span class="op">=</span> <span class="fl">1</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">matrix_example</span></span>
<span><span class="co">#&gt;             anomia67 powerless67 anomia71 powerless71 education     sei</span></span>
<span><span class="co">#&gt; anomia67      11.834       6.947    6.819       4.783    -3.839 -21.899</span></span>
<span><span class="co">#&gt; powerless67    6.947       9.364    5.091       5.028    -3.889 -18.831</span></span>
<span><span class="co">#&gt; anomia71       6.819       5.091   12.532       7.495    -3.841 -21.748</span></span>
<span><span class="co">#&gt; powerless71    4.783       5.028    7.495       9.986    -3.625 -18.775</span></span>
<span><span class="co">#&gt; education     -3.839      -3.889   -3.841      -3.625     9.610  35.522</span></span>
<span><span class="co">#&gt; sei          -21.899     -18.831  -21.748     -18.775    35.522 450.288</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ggsem-application">ggsem Application<a class="anchor" aria-label="anchor" href="#ggsem-application"></a>
</h2>
<p>Let’s open the application and visualize a SEM diagram with the
data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggsem.html">ggsem</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>First, readers should download data from <a href="https://www.smin95.com/HolzingerSwineford1939.csv" class="external-link uri">https://www.smin95.com/HolzingerSwineford1939.csv</a> and
load it on the app in the <strong>Data and Model Specifics</strong> menu
of <strong>SEM Data</strong>. We check box for <strong>Data
frame</strong> so that our data file is interpreted correctly.</p>
<p><img src="fig6a.png" width="40%" style="display: block; margin: auto;"></p>
<p>After loading the data, users can draw a SEM by clicking the
<strong>Draw a SEM</strong> button.</p>
<p><img src="fig6b.png" width="100%" style="display: block; margin: auto;"></p>
<p>The default color of the latent nodes is red, that of the observed
nodes is blue, and the that of the node label is white. However, these
can be modified using input menu in <strong>Node Settings</strong> and
<strong>Edge Settings</strong>. Apply aesthetic changes to the existing
SEM diagram using the <strong>Apply Changes</strong> button.</p>
<p><img src="fig6c.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>Unlike in Chapter 3, where we drew a SEM diagram without data, we
have drawn a SEM diagram with data, allowing the <strong>ggsem</strong>
to perform statistical analyses. Hence, the SEM diagram has edge labels
with parameter estimate values computed from the <em>lavaan</em>
package. Those with statistical significance (p &lt; 0.05) are labelled
with asterisks (*). These graphical outputs can be accessed in the
<em>Annotations</em> table below the plotting space. The rows
representing the edge labels have white color rather than red because
these are <strong>unlocked</strong>.</p>
<p>Notice that the default model syntax actually agrees with the data
frame in this example. So, if you decide to use your own data, make sure
to change the lavaan model. If you decide to use matrix as data file,
make sure to change your <strong>Custom SEM Code</strong> as:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">lavaan_string</span>, sample.cov <span class="op">=</span> <span class="va">data</span>, sample.nobs <span class="op">=</span> <span class="va">...</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>In the <strong>ggsem</strong> app, <code>lavaan_string</code> stores
your syntax input, <code>data</code> object stores the data you have
uploaded. So, if these two things get changed in <strong>Custom SEM
Code</strong>, error will occur. While these things should remain
unchanged, other arguments can be added for specific analyses, such as
<code>sample.cov</code> and <code>sample.nobs</code> to fit the model
(<code>lavaan_string</code>) with a covariance matrix data.</p>
<p>Their unlocked status (from their <em>locked</em> column) allows
users to group them aesthetically and modify their X and Y positions at
once. To do it, go to <strong>Text Annotation</strong> menu. Make sure
<strong>Shift XY Only</strong> is checked in the <strong>Aesthetics
Grouping</strong> sub-menu.</p>
<p><img src="fig6d.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>In this example, we will shift the position of X and Y by a unit of
1. After inputing these values, click the <strong>Apply Changes</strong>
button.</p>
<p>It is important to remember that <strong>Apply Changes</strong>
button changes aesthetics of elements whose <strong>lavaan</strong>
column is set to <code>TRUE</code>. So, other elements drawn separately
(from individual points to network diagrams) will not be influenced.</p>
<p><img src="fig6e.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>Next, we will perform another modification using aesthetic grouping.
We will enlarge the edge labels slightly. Under <strong>Draw Individual
Annotations</strong> menu, input <strong>Text Size</strong> as 16. For
<strong>Aesthetic Grouping</strong>, check <strong>Aesthetics
Only</strong> to change aesthetics of unlocked annotations in group.</p>
<p>Finally, we add text annotation <em>SEM Diagram</em> at <strong>X =
-2</strong>, <strong>Y = 32</strong> with <strong>text size =
23</strong> and <strong>fontface = bold</strong> by clicking the
<strong>Add Annotation</strong> button in the <strong>Text
Annotations</strong> menu.</p>
<p>When saving as a <em>png</em> file, users can select the x range and
y range of the figure to remove surrounding white space. We set the
range of X axis from -29 to 29 and Y axis from -32 to 36.</p>
<p><img src="fig6g.png" width="40%" style="display: block; margin: auto;"></p>
<p>This is the final png image after removing unnecessary white space
from the <em>ggsem</em> application without any coding.</p>
<p><img src="fig6f.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>This can be produced with codes using the function
<code><a href="../reference/adjust_axis_range.html">adjust_axis_range()</a></code> as shown below. In fact, the
<strong>ggsem</strong> app uses this function to save figure
outputs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Don't run. Not a real code.</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csv_to_ggplot.html">csv_to_ggplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="va">plot_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_axis_range.html">adjust_axis_range</a></span><span class="op">(</span><span class="va">plot</span>, </span>
<span>                                  x_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">29</span>, <span class="fl">29</span><span class="op">)</span>, </span>
<span>                                  y_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">32</span>, <span class="fl">36</span><span class="op">)</span>,</span>
<span>                                  fixed_aspect_ratio <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="../reference/save_figure.html">save_figure</a></span><span class="op">(</span><span class="st">"fig6g.png"</span>, <span class="va">plot_adjusted</span><span class="op">)</span> <span class="co"># same as the app</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.smin95.com" class="external-link">Seung Hyun Min</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
